var dataTD,temp="ºC",barPadding=2,margin={top:50,right:50,bottom:50,left:110},widthTD=1200-margin.left-margin.right,heightTD=500-margin.top-margin.bottom,color=d3.scaleLinear().domain([10,35]).range(["#d39c83","#e34f6f","#7c1d6f"]),divTD=d3.select(".tropicales-dia").append("div").attr("class","tooltip-tropical-container").style("opacity",0);function getYear(t){return t.split("-")[2]}function removeYear(t){return t.substring(0,5)}var svgTD=d3.select(".tropicales-dia").append("svg").attr("class","tropicales-dia-chart").attr("viewBox","0 0 "+(widthTD+margin.left+margin.right)+" "+(heightTD+margin.top+margin.bottom)).append("g").attr("transform","translate("+(margin.left-margin.right)+","+margin.top+")"),xRangeTD=d3.scaleLinear().range([30,widthTD]),yRangeTD=d3.scaleLinear().range([heightTD,-20]),xAxisTD=d3.axisBottom(xRangeTD).tickPadding(15).tickFormat(d3.format("d")).tickSize(-heightTD).ticks(20),yAxisTD=d3.axisLeft(yRangeTD).tickPadding(10).tickFormat(function(t){return t+temp}).tickSize(30-widthTD).ticks(6);d3.csv("csv/tropicales-por-dia.csv",function(t,a){(dataTD=a).forEach(function(t){t.fecha=t.fecha,t.dias=removeYear(t.fecha),t.minima=t.min,t.year=getYear(t.fecha),console.log(t.year)}),xRangeTD.domain([d3.min(dataTD,function(t){return t.year}),d3.max(dataTD,function(t){return t.year})]),yRangeTD.domain([d3.min(dataTD,function(t){return t.minima}),d3.max(dataTD,function(t){return t.minima})]),svgTD.append("g").attr("class","xAxisTD").attr("transform","translate(0,400)").transition().duration(1e3).call(xAxisTD),svgTD.append("g").attr("class","yAxisTD").attr("transform","translate(30, 0)").transition().duration(1e3).call(yAxisTD),svgTD.selectAll("dot").data(dataTD).enter().append("circle").attr("class","circles").on("mouseover",function(t){divTD.transition(),divTD.style("opacity",1).html('<p class="tooltipTropical">El '+t.fecha+" se registró una mínima de "+t.minima+"º<p/>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(t){divTD.transition().duration(4e3).style("opacity",0)}).transition().duration(1e3).attr("cx",function(t){return xRangeTD(t.year)}).attr("cy",function(t){return yRangeTD(t.minima)}).attr("r",6).style("fill","#DD435C").attr("fill-opacity",.5)});