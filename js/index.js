function getYear(a){return a.split("-")[2]}function update(){var a=d3.select("#updateButtonDay").property("value")+"-"+d3.select("#updateButtonMonth").property("value");console.log(a);var t=new RegExp("^.*"+a+".*","gi");d3.csv("temperaturas.csv",function(a,i){(dataFiltered=i.filter(function(a){return String(a.fecha).match(t)})).forEach(function(a){a.fecha=a.fecha,a.maxima=+a.maxima,a.minima=+a.minima,a.year=getYear(a.fecha)}),maxTemp=d3.max(dataFiltered,function(a){return a.maxima}),minTemp=d3.min(dataFiltered,function(a){return a.maxima}),xRange.domain([d3.min(dataFiltered,function(a){return a.year}),d3.max(dataFiltered,function(a){return a.year})]),yRange.domain([d3.min(dataFiltered,function(a){return a.maxima}),d3.max(dataFiltered,function(a){return a.maxima})]),d3.select(".yAxis").transition().duration(1e3).call(yAxis),d3.select(".xAxis").transition().duration(1e3).call(xAxis),d3.select(".legend-top").text("Temperaturas máximas");var e=svg.selectAll("circle").data(dataFiltered);e.transition().duration(1e3).attr("r",function(a){return a.maxima===maxTemp?6*Math.sqrt(a.maxima/Math.PI):a.maxima===minTemp?6*Math.sqrt(a.maxima/Math.PI):4*Math.sqrt(a.maxima/Math.PI)}).attr("cx",function(a){return xRange(a.year)}).attr("cy",function(a){return yRange(a.maxima)}),e.style("fill",function(a){return a.maxima===maxTemp?"#70284a":a.maxima===minTemp?"#045275":color(a.maxima)}),e.on("mouseover",function(a){div.transition(),div.style("opacity",1).html('<p class="tooltipYear">'+a.year+'<p/><p class="tooltipTemp">'+a.maxima+"º<p/>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(a){div.transition().duration(200).style("opacity",0)}),e.exit().remove()})}function updateMin(){var a=d3.select("#updateButtonDayMin").property("value")+"-"+d3.select("#updateButtonMonthMin").property("value");console.log(a);var t=new RegExp("^.*"+a+".*","gi");d3.csv("temperaturas.csv",function(a,i){(dataFiltered=i.filter(function(a){return String(a.fecha).match(t)})).forEach(function(a){a.fecha=a.fecha,a.maxima=+a.maxima,a.minima=+a.minima,a.year=getYear(a.fecha)}),maxTemp=d3.max(dataFiltered,function(a){return a.minima}),minTemp=d3.min(dataFiltered,function(a){return a.minima}),xRange.domain([d3.min(dataFiltered,function(a){return a.year}),d3.max(dataFiltered,function(a){return a.year})]),yRange.domain([d3.min(dataFiltered,function(a){return a.minima}),d3.max(dataFiltered,function(a){return a.minima})]);d3.scaleLinear().domain([0,25]).range(["#b0f2bc","#89e8ac","#67dba5","#4cc8a3","#38b2a3","#2c98a0","#257d98"]);d3.select(".yAxis").transition().duration(1e3).call(yAxis),d3.select(".xAxis").transition().duration(1e3).call(xAxis),d3.select(".legend-top").text("Temperaturas mínimas");var e=svg.selectAll("circle").data(dataFiltered);e.transition().duration(1e3).attr("r",function(a){return a.minima===maxTemp?10*Math.sqrt(a.minima/Math.PI):a.minima===minTemp?10*Math.sqrt(a.minima/Math.PI):a.minima>=20?11:a.minima>=18?10:a.minima>=14?9:a.minima>=10?8:a.minima>=5?7:a.minima>=0?6:a.minima<=0?4:void 0}).attr("cx",function(a){return xRange(a.year)}).attr("cy",function(a){return yRange(a.minima)}),e.style("fill",function(a){return a.minima===maxTemp?"#70284a":a.minima===minTemp?"#045275":a.minima>=20?"#b0f2bc":a.minima>=18?"#89e8ac":a.minima>=14?"#67dba5":a.minima>=10?"#4cc8a3":a.minima>=5?"#38b2a3":a.minima>=0?"#2c98a0":a.minima<=0?"#257d98":void 0}),e.on("mouseover",function(a){div.transition(),div.style("opacity",1).html('<p class="tooltipYear">'+a.year+'<p/><p class="tooltipTemp">'+a.minima+"º<p/>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(a){div.transition().duration(200).style("opacity",0)}),e.exit().remove()})}var dataFiltered,xRange,yRange,xAxis,yAxis,temp="ºC",barPadding=2,margin={top:50,right:50,bottom:50,left:110},width=1200-margin.left-margin.right,height=500-margin.top-margin.bottom,color=d3.scaleLinear().domain([10,35]).range(["#d39c83","#e34f6f","#7c1d6f"]),div=d3.select(".grafica-temp").append("div").attr("class","tooltip").style("opacity",0),svg=d3.select(".grafica-temp").append("svg").attr("class","chart-temp").attr("viewBox","0 0 "+(width+margin.left+margin.right)+" "+(height+margin.top+margin.bottom)).append("g").attr("transform","translate("+(margin.left-margin.right)+","+margin.top+")"),xRange=d3.scaleLinear().range([30,width]),yRange=d3.scaleLinear().range([height,0]),xAxis=d3.axisBottom().scale(xRange).tickPadding(15).tickFormat(d3.format("d")).tickSize(-height).ticks(20),yAxis=d3.axisLeft().scale(yRange).tickPadding(10).tickFormat(function(a){return a+temp}).tickSize(30-width).ticks(6);d3.csv("temperaturas.csv",function(a,t){(dataFiltered=t.filter(function(a){return String(a.fecha).match(/01-06/)})).forEach(function(a){a.fecha=a.fecha,a.maxima=+a.maxima,a.minima=+a.minima,a.year=getYear(a.fecha)}),maxTemp=d3.max(dataFiltered,function(a){return a.maxima}),minTemp=d3.min(dataFiltered,function(a){return a.maxima}),xRange.domain([d3.min(dataFiltered,function(a){return a.year}),d3.max(dataFiltered,function(a){return a.year})]),yRange.domain([d3.min(dataFiltered,function(a){return a.maxima}),d3.max(dataFiltered,function(a){return a.maxima})]),svg.append("g").attr("class","xAxis").attr("transform","translate(0,400)").transition().duration(1e3).call(xAxis),svg.append("g").attr("class","yAxis").attr("transform","translate(30, 0)").transition().duration(1e3).call(yAxis),svg.append("text").attr("class","legend-top").attr("transform","rotate(0)").attr("y",-20).attr("x",190).style("text-anchor","end").text("Temperaturas máximas"),svg.selectAll("dot").data(dataFiltered).enter().append("circle").attr("class","circles").on("mouseover",function(a){div.transition(),div.style("opacity",1).html('<p class="tooltipYear">'+a.year+'<p/><p class="tooltipTemp">'+a.maxima+"º<p/>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(a){div.transition().duration(200).style("opacity",0)}).transition().duration(1e3).attr("cx",function(a){return xRange(a.year)}).attr("cy",function(a){return yRange(a.maxima)}).attr("r",function(a){return a.maxima===maxTemp?6*Math.sqrt(a.maxima/Math.PI):a.maxima===minTemp?6*Math.sqrt(a.maxima/Math.PI):4*Math.sqrt(a.maxima/Math.PI)}).style("fill",function(a){return a.maxima===maxTemp?"#70284a":a.maxima===minTemp?"#045275":color(a.maxima)})});var svgH=d3.select(".heladas").append("svg").attr("class","chart-heladas").attr("viewBox","0 0 "+(width+margin.left+margin.right)+" "+(height+margin.top+margin.bottom)).append("g").attr("transform","translate("+(margin.left-margin.right)+","+margin.top+")");widthBar=width/66;var xRangeH=d3.scaleLinear().range([30,width]),yRangeH=d3.scaleLinear().range([height,0]),xAxisH=d3.axisBottom().scale(xRangeH).tickFormat(d3.format("d")).ticks(20),yAxisH=d3.axisLeft().scale(yRangeH).tickSize(16-width).ticks(5),colorsH=d3.scaleLinear().domain([10,35]).range(["#68abb8","#4f90a6","#3b738f","#2a5674"]);d3.csv("heladas.csv",function(a,t){datosH=t,datosH.forEach(function(a){a.anyo=a.fecha,a.dia=a.dias}),xRangeH.domain([d3.min(datosH,function(a){return a.anyo}),d3.max(datosH,function(a){return a.anyo})]),yRangeH.domain([0,d3.max(datosH,function(a){return a.dia})]),svgH.append("g").attr("class","xAxis").attr("transform","translate(0,400)").call(xAxisH),svgH.append("g").attr("class","yAxis").attr("transform","translate(30, 0)").call(yAxisH),svgH.selectAll("rect").data(datosH).enter().append("rect").attr("class","barra").attr("width",width/datosH.length-barPadding).on("mouseover",function(a){div.transition(),div.style("opacity",1).html('<p class="tooltipHeladas">'+a.anyo+'<p/><p class="tooltipHeladas">'+a.dia+"<p/>").style("left",d3.event.pageX-50+"px").style("top",d3.event.pageY-100+"px")}).on("mouseout",function(a){div.transition().duration(200).style("opacity",0)}).attr("fill",function(a,t){return colorsH(t)}).attr("x",function(a){return xRangeH(a.anyo)}).attr("y",function(a){return yRangeH(a.dias)}).attr("height",function(a){return height-yRangeH(a.dias)})});var svgT=d3.select(".tropicales").append("svg").attr("class","chart-tropicales").attr("viewBox","0 0 "+(width+margin.left+margin.right)+" "+(height+margin.top+margin.bottom)).append("g").attr("transform","translate("+(margin.left-margin.right)+","+margin.top+")");widthBar=width/66;var xRangeT=d3.scaleLinear().range([30,width]),yRangeT=d3.scaleLinear().range([height,0]),xAxisT=d3.axisBottom().scale(xRangeT).tickFormat(d3.format("d")).ticks(20),yAxisT=d3.axisLeft().scale(yRangeT).tickSize(16-width).ticks(5),colorsT=d3.scaleLinear().domain([0,45]).range(["#ffc6c4","#f4a3a8","#e38191","#cc607d","#ad466c","#8b3058","#672044"]);d3.csv("tropicales.csv",function(a,t){datosT=t,datosT.forEach(function(a){a.anyo=a.fecha,a.dia=a.dias}),xRangeT.domain([d3.min(datosT,function(a){return a.anyo}),d3.max(datosT,function(a){return a.anyo})]),yRangeT.domain([0,d3.max(datosT,function(a){return a.dia})]),svgT.append("g").attr("class","xAxis").attr("transform","translate(0,400)").call(xAxisT),svgT.append("g").attr("class","yAxis").attr("transform","translate(30, 0)").call(yAxisT),svgT.selectAll("rect").data(datosT).enter().append("rect").attr("class","barra").attr("width",width/datosT.length-barPadding).on("mouseover",function(a){div.transition(),div.style("opacity",1).html('<p class="tooltipTropicales">'+a.anyo+'<p/><p class="tooltipTropicales">'+a.dia+"<p/>").style("left",d3.event.pageX+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(a){div.transition().duration(200).style("opacity",0)}).attr("fill",function(a,t){return colorsT(t)}).attr("x",function(a){return xRangeH(a.anyo)}).attr("y",function(a){return yRangeH(a.dias)}).attr("height",function(a){return height-yRangeH(a.dias)})});